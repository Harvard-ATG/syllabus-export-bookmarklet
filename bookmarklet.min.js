javascript: void(function(){function paginated_fetch(url=is_required("url"),page=1,previousResponse=[]){return fetch(`${url}&page=${page}`).then(response=>response.json()).then(newResponse=>{const response=[...previousResponse,...newResponse];return 0!==newResponse.length?(page++,paginated_fetch(url,page,response)):response})}function Event(title,description,start,end){this.title=title,this.description=description,this.start=start,this.end=end}const courseIdMatch=/courses\/(\d+)/;let match,courseId=courseIdMatch.exec(window.location.pathname)[1];const fetchCourse=fetch(`/api/v1/courses/${courseId}?include[]=syllabus_body`).then(res=>res.json()),fetchCalendar=paginated_fetch(`/api/v1/calendar_events?context_codes[]=course_${courseId}&all_events=true`).then(res=>{let events=[];return res.forEach(calendarEvent=>{let event=new Event(calendarEvent.title,calendarEvent.description,new Date(calendarEvent.start_at),new Date(calendarEvent.end_at));events.push(event)}),events}),fetchAssignments=paginated_fetch(`/api/v1/courses/${courseId}/assignments?ignoreThis=sure`).then(res=>{let events=[];return res.forEach(assignment=>{let event=new Event(assignment.name,assignment.description,assignment.due_at?new Date(assignment.due_at):null,null);events.push(event)}),events}),fetchAssignmentGroups=paginated_fetch(`/api/v1/courses/${courseId}/assignment_groups?ignoreThis=sure`);Promise.all([fetchCourse,fetchCalendar,fetchAssignments,fetchAssignmentGroups]).then(values=>{let course=values[0],events=[...values[1],...values[2]];events.sort((a,b)=>a.start-b.start);let assignmentGroups=values[3],dateOptions={weekday:"short",year:"numeric",month:"short",day:"numeric"},timeOptions={hour12:!0,hour:"2-digit",minute:"2-digit"},content=`<h1>${course.name}</h1>${course.syllabus_body}<h2>Course Schedule</h2>`;content+="<table><tr><th>Date</th><th>Details</th></tr>",events.forEach(event=>{let dateString=event.start?event.start.toLocaleDateString("en-us",dateOptions):"";if(event.start&&event.end)var timeString=`${event.start.toLocaleTimeString("en-US",timeOptions)} to ${event.end.toLocaleTimeString("en-US",timeOptions)}`;else if(event.start)var timeString=event.start.toLocaleTimeString("en-US",dateOptions);else var timeString="";content+=`<tr><td>${dateString}</td>`,content+=`<td><strong>${event.title}</strong><br/>${event.description}</td>`,content+=`<td>${timeString}`}),content+="</table>",content+="<h2>Assignment Weights</h2>",content+="<table><tr><th>Assignment Group</th><th>Weight</th></tr>",assignmentGroups.forEach(group=>{content+=`<tr><td>${group.name}</td>`,content+=`<td>${group.group_weight} %</td></tr>`}),content+="</table>";let win=window.open("","Syllabus Export","width=600,height=400");win.document.body.innerHTML=content,win.print(),win.close()})}());